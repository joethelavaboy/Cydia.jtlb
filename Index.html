<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Downloading Packages - Cydia Inspired Skeuomorphic</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* BASE & LAYOUT */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(to bottom, #d5dee6 0%, #c4d0da 100%);
            margin: 0;
            padding: 0;
            color: #333;
            -webkit-font-smoothing: antialiased;
            user-select: none;
        }

        .screen {
            padding-bottom: 60px; /* Space for the fixed bottom nav */
        }
        .screen.hidden {
            display: none;
        }

        /* SKEUOMORPHIC STYLES */

        /* Status Bar (Top Black Bar) */
        .status-bar {
            background-color: #333;
            color: #fff;
            padding: 5px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            border-bottom: 1px solid #000;
            text-shadow: 0 -1px 0 rgba(0,0,0,0.5);
            font-weight: 600;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 10;
        }
        .status-bar .left, .status-bar .right { display: flex; align-items: center; }
        .status-bar .left i { margin-left: 5px; }
        .status-bar .right i { margin-right: 5px; }

        /* Navigation Bar (Top Silver Bar) */
        .nav-bar {
            background: linear-gradient(to bottom, #f0f0f0 0%, #dcdcdc 100%);
            border-top: 1px solid #f0f0f0;
            border-bottom: 1px solid #9c9c9c;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.8), 0 1px 2px rgba(0,0,0,0.2);
            position: fixed;
            top: 29px; /* Below status bar */
            width: 100%;
            z-index: 9;
        }

        .nav-bar button {
            background: linear-gradient(to bottom, #6faaff 0%, #3e8ae6 100%);
            color: white;
            border: 1px solid #2a6ecb;
            border-radius: 5px;
            padding: 7px 15px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.4), 0 1px 2px rgba(0,0,0,0.3);
            text-shadow: 0 -1px 0 rgba(0,0,0,0.5);
            -webkit-appearance: none;
            transition: background-color 0.1s ease;
        }
        .nav-bar button:active {
            background: linear-gradient(to bottom, #3e8ae6 0%, #6faaff 100%);
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.4), 0 0 1px rgba(0,0,0,0.5);
        }
        .nav-bar button.gray {
            background: linear-gradient(to bottom, #ffffff 0%, #ededed 50%, #d8d8d8 100%);
            border: 1px solid #a0a0a0;
            color: #444;
            text-shadow: 0 1px 0 rgba(255,255,255,0.8);
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.8), 0 1px 2px rgba(0,0,0,0.2);
        }
        .nav-bar button.gray:active {
            background: linear-gradient(to bottom, #d8d8d8 0%, #ededed 50%, #ffffff 100%);
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.4), 0 0 1px rgba(0,0,0,0.5);
        }
        .nav-bar .title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            text-align: center;
            flex-grow: 1;
            margin: 0 10px;
            text-shadow: 0 1px 0 rgba(255,255,255,0.8);
        }
        
        /* Loading Header (Used on Changes screen) */
        .loading-header {
            background: linear-gradient(to bottom, #fefefe 0%, #e0e0e0 100%);
            padding: 10px 15px;
            border-bottom: 1px solid #c0c0c0;
            border-top: 1px solid #fcfcfc;
            display: flex;
            align-items: center;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.8);
            font-size: 16px;
            color: #444;
            text-shadow: 0 1px 0 rgba(255,255,255,0.8);
            margin-top: 70px; /* Offset for fixed top bars */
        }
        .loading-spinner {
            border: 3px solid #eee;
            border-top: 3px solid #6699ff;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            animation: spin 1s linear infinite;
            margin-right: 10px;
            box-shadow: 0 1px 1px rgba(0,0,0,0.1);
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Content Area (Rounded Rectangle) */
        .content {
            background-color: #fefefe;
            margin: 10px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border: 1px solid #d0d0d0;
        }
        .section-header {
            background: linear-gradient(to bottom, #e8e8e8 0%, #d8d8d8 100%);
            padding: 8px 15px;
            font-size: 14px;
            font-weight: bold;
            color: #555;
            border-top: 1px solid #e0e0e0;
            border-bottom: 1px solid #b0b0b0;
            text-shadow: 0 1px 0 rgba(255,255,255,0.8);
        }

        /* List Items & Icons */
        .package-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            background-color: #fff;
            transition: background-color 0.1s ease;
            cursor: pointer;
        }
        .package-item:last-child { border-bottom: none; }
        .package-item:active { background-color: #e6e6e6; }
        .package-item .info h3 { margin: 0; font-size: 16px; color: #333; text-shadow: 0 1px 0 rgba(255,255,255,0.8); }
        .package-item .info p { margin: 2px 0 0; font-size: 13px; color: #666; text-shadow: 0 1px 0 rgba(255,255,255,0.8); }
        .package-item .arrow { margin-left: auto; font-size: 20px; color: #aaa; text-shadow: 0 1px 0 rgba(255,255,255,0.8); font-weight: 200; }
        .package-item .icon {
            width: 40px; height: 40px; border-radius: 8px; margin-right: 12px;
            border: 1px solid #c0c0c0; box-shadow: inset 0 1px 0 rgba(255,255,255,0.8), 0 1px 2px rgba(0,0,0,0.2);
            display: flex; justify-content: center; align-items: center; font-size: 20px;
            color: #fff; flex-shrink: 0; position: relative; overflow: hidden;
            text-shadow: 0 -1px 0 rgba(0,0,0,0.4); /* Dark shadow for colored icons */
        }
        .package-item .icon.cydia-box { background: linear-gradient(to bottom, #d69467 0%, #a66a40 100%); border: 1px solid #8e5c38; }
        .package-item .icon.cydia-box::before { content: ''; position: absolute; width: 70%; height: 30%; background: linear-gradient(to bottom right, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0.1) 50%, rgba(0,0,0,0.1) 100%); border-radius: 3px; transform: skewX(-20deg) rotate(-5deg); top: 5px; left: 5px; border: 1px solid rgba(0,0,0,0.2); box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .package-item .icon.cydia-box::after { content: ''; position: absolute; width: 60%; height: 60%; background-color: rgba(255,255,255,0.8); border-radius: 3px; bottom: 5px; right: 5px; border: 1px solid rgba(0,0,0,0.2); box-shadow: inset 0 1px 3px rgba(0,0,0,0.2); }
        .icon.fb { background-color: #3b5998; border: 1px solid #2d4373; }
        .icon.twitter { background-color: #1da1f2; border: 1px solid #0c85d0; }
        .icon.themes { background: linear-gradient(to bottom, #a0d4a0 0%, #5cb85c 100%); border: 1px solid #4cae4c; }
        .icon.settings { background: linear-gradient(to bottom, #b0b0b0 0%, #808080 100%); border: 1px solid #666; }
        .icon.sources { background: linear-gradient(to bottom, #f7d77b 0%, #e8c65f 100%); border: 1px solid #c4a13f; color: #7d6423; text-shadow: none; }
        .icon.packages { background: linear-gradient(to bottom, #f29a9a 0%, #dc6f6f 100%); border: 1px solid #b74c4c; }
        .icon.search { background: linear-gradient(to bottom, #e0e0e0 0%, #c0c0c0 100%); border: 1px solid #a0a0a0; color: #444; text-shadow: none; }
        
        /* Bottom Navigation Bar (Fixed) */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(to bottom, #d5d5d5 0%, #b0b0b0 100%);
            border-top: 1px solid #999;
            display: flex;
            justify-content: space-around;
            padding: 5px 0;
            box-shadow: 0 -1px 3px rgba(0,0,0,0.2);
            height: 49px;
            z-index: 10;
        }
        .bottom-nav-item {
            text-align: center;
            color: #606060;
            font-size: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            padding: 2px 0;
            cursor: pointer;
            text-shadow: 0 1px 0 rgba(255,255,255,0.8);
            transition: color 0.1s ease;
        }
        .bottom-nav-item.active {
            color: #004d99;
            text-shadow: 0 0 5px rgba(0, 77, 153, 0.5); /* Subtle blue glow/shadow */
        }
        .bottom-nav-item i { font-size: 22px; margin-bottom: 3px; position: relative; top: 1px; }

        /* Generic Input field styling for search bar */
        input[type="text"] {
            padding: 0;
            border: none;
            background: transparent;
            outline: none;
        }

    </style>
</head>

<body>
    <div class="status-bar">
        <div class="left">
            <span>9:41 AM</span>
            <i class="fas fa-location-arrow" title="Location Services Active"></i>
        </div>
        <div class="right">
            <span>iPhone</span>
            <i class="fas fa-wifi"></i>
            <i class="fas fa-battery-three-quarters"></i>
        </div>
    </div>

    <div class="nav-bar">
        <button class="gray" id="top-nav-button" onclick="goBack()">
            <i class="fas fa-chevron-left"></i> Packages
        </button>
        <span class="title">Downloading Packages</span>
        <span style="width: 100px;"></span> 
    </div>

    <div id="screen-container">

        <div id="screen-changes" class="screen">
            <div class="loading-header" id="loading-bar">
                <div class="loading-spinner"></div>
                <span>Running installation...</span>
                <button class="blue-button" style="margin-left: auto;" onclick="cancelProcess()">Cancel</button>
            </div>
            <div class="content">
                <div class="section-header">Installing</div>
                <div class="package-item" onclick="viewPackage('Cydia Installer')">
                    <div class="icon cydia-box"></div>
                    <div class="info"><h3>Cydia Installer</h3><p>Essential Upgrade (12.1MB)</p></div>
                    <i class="fas fa-chevron-right arrow"></i>
                </div>
                <div class="package-item" onclick="viewPackage('Facebook++')">
                    <div class="icon fb"><i class="fab fa-facebook-f"></i></div>
                    <div class="info"><h3>Facebook++</h3><p>Tweak for Facebook App (3.4MB)</p></div>
                    <i class="fas fa-chevron-right arrow"></i>
                </div>
                <div class="section-header">Pending Removal</div>
                <div class="package-item" onclick="viewPackage('TwitterAdsBlocker')">
                    <div class="icon twitter"><i class="fab fa-twitter"></i></div>
                    <div class="info"><h3>TwitterAdsBlocker</h3><p>Will be removed (0.1MB)</p></div>
                    <i class="fas fa-chevron-right arrow"></i>
                </div>
            </div>
        </div>

        <div id="screen-search" class="screen hidden">
            <div class="content" style="margin-top: 70px;">
                <div class="section-header">Search Packages</div>
                <div class="package-item" onclick="alert('Typing to search...')">
                    <div class="icon search"><i class="fas fa-search"></i></div>
                    <div class="info">
                        <input type="text" placeholder="Enter package name or keyword..." style="width: 100%;" onfocus="this.style.color='#000'" onblur="this.style.color=''">
                    </div>
                </div>
                <div class="section-header">Popular Searches</div>
                <div class="package-item" onclick="viewPackage('WinterBoard')"><div class="info"><h3>WinterBoard</h3></div><div class="arrow">></div></div>
                <div class="package-item" onclick="viewPackage('iFile')"><div class="info"><h3>iFile</h3></div><div class="arrow">></div></div>
            </div>
        </div>

        <div id="screen-manage" class="screen hidden">
            <div class="content" style="margin-top: 70px;">
                <div class="section-header">Package Management</div>
                <div class="package-item" onclick="alert('Viewing Storage usage...')">
                    <div class="icon settings"><i class="fas fa-database"></i></div>
                    <div class="info"><h3>Storage</h3></div><div class="arrow">></div>
                </div>
                <div class="package-item" onclick="showScreen('screen-sources', 'Sources')">
                    <div class="icon sources"><i class="fas fa-folder-open"></i></div>
                    <div class="info"><h3>Sources</h3></div><div class="arrow">></div>
                </div>
                <div class="package-item" onclick="showScreen('screen-installed', 'Installed')">
                    <div class="icon packages"><i class="fas fa-box"></i></div>
                    <div class="info"><h3>Packages</h3></div><div class="arrow">></div>
                </div>
            </div>
        </div>

        <div id="screen-sources" class="screen hidden">
            <div class="content" style="margin-top: 70px;">
                <div class="section-header">Default Repositories</div>
                <div class="package-item" onclick="viewSource('Telesphoreo')"><div class="info"><h3>Telesphoreo</h3></div><div class="arrow">></div></div>
                <div class="package-item" onclick="viewSource('BigBoss')"><div class="info"><h3>BigBoss</h3></div><div class="arrow">></div></div>
                <div class="section-header">User Repositories</div>
                <div class="package-item" onclick="alert('Tapping Edit will allow you to add new sources.')"><div class="info"><p>Tap Edit to add sources</p></div></div>
            </div>
        </div>

        <div id="screen-installed" class="screen hidden">
            <div class="content" style="margin-top: 70px;">
                <div class="section-header">Installed Packages (User)</div>
                <div class="package-item" onclick="viewPackage('SBSettings')"><div class="info"><h3>SBSettings</h3></div><div class="arrow">></div></div>
                <div class="package-item" onclick="viewPackage('Barrel')"><div class="info"><h3>Barrel</h3></div><div class="arrow">></div></div>
                <div class="section-header">Installed Packages (System)</div>
                <div class="package-item" onclick="viewPackage('Substrate')"><div class="info"><h3>Substrate</h3></div><div class="arrow">></div></div>
            </div>
        </div>
        
    </div>

    <div class="bottom-nav">
        <div class="bottom-nav-item" onclick="showScreen('screen-manage', 'Manage')">
            <i class="fas fa-cog"></i>
            <span>Manage</span>
        </div>
        <div class="bottom-nav-item" onclick="showScreen('screen-sources', 'Sources')">
            <i class="fas fa-folder-open"></i>
            <span>Sources</span>
        </div>
        <div class="bottom-nav-item active" onclick="showScreen('screen-changes', 'Downloading Packages')">
            <i class="fas fa-wrench"></i>
            <span>Changes</span>
        </div>
        <div class="bottom-nav-item" onclick="showScreen('screen-installed', 'Installed')">
            <i class="fas fa-box"></i>
            <span>Installed</span>
        </div>
        <div class="bottom-nav-item" onclick="showScreen('screen-search', 'Search')">
            <i class="fas fa-search"></i>
            <span>Search</span>
        </div>
    </div>

    <script>
        function goBack() {
            alert("Navigating back to the previous screen (e.g., a package list).");
        }

        function cancelProcess() {
            document.getElementById('loading-bar').classList.add('hidden');
            alert("Installation process canceled! The loading bar is now hidden.");
        }

        function viewPackage(packageName) {
            alert("Showing details for: " + packageName + "\n(This is where you modify or install the package.)");
        }
        
        function viewSource(sourceName) {
            alert("Showing packages from the " + sourceName + " repository.");
        }

        function showScreen(screenId, navTitle) {
            const topNavButton = document.getElementById('top-nav-button');
            const navTitleElement = document.querySelector('.nav-bar .title');
            
            // 1. Hide all screens and remove margin-top from the content div for the next screen to use the fixed header area.
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => {
                screen.classList.add('hidden');
            });
            
            // 2. Show the selected screen
            document.getElementById(screenId).classList.remove('hidden');

            // 3. Update the navigation bar title
            navTitleElement.textContent = navTitle;

            // 4. Update the active bottom nav item
            const navItems = document.querySelectorAll('.bottom-nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('onclick').includes(screenId)) {
                    item.classList.add('active');
                }
            });

            // 5. Adjust top nav button based on context
            if (screenId === 'screen-search') {
                topNavButton.innerHTML = 'Cancel';
                topNavButton.setAttribute('onclick', 'showScreen("screen-changes", "Downloading Packages")');
                topNavButton.classList.remove('gray');
                topNavButton.style.backgroundColor = 'transparent'; 
                topNavButton.style.color = '#007aff'; 
                topNavButton.style.border = 'none';
                topNavButton.style.boxShadow = 'none';
                topNavButton.style.textShadow = '0 1px 0 rgba(255,255,255,0.8)';
            } else if (screenId === 'screen-sources' || screenId === 'screen-installed') {
                topNavButton.innerHTML = '<i class="fas fa-chevron-left"></i> Manage';
                topNavButton.setAttribute('onclick', 'showScreen("screen-manage", "Manage")');
                topNavButton.classList.add('gray'); // Ensure gray style is applied
                topNavButton.style.color = '';
                topNavButton.style.backgroundColor = '';
                topNavButton.style.border = '';
                topNavButton.style.boxShadow = '';
                topNavButton.style.textShadow = '';
            } 
            else {
                // Default style for 'Changes' and 'Manage' screens
                topNavButton.innerHTML = '<i class="fas fa-chevron-left"></i> Packages';
                topNavButton.setAttribute('onclick', 'goBack()');
                topNavButton.classList.add('gray'); 
                topNavButton.style.color = '';
                topNavButton.style.backgroundColor = '';
                topNavButton.style.border = '';
                topNavButton.style.boxShadow = '';
                topNavButton.style.textShadow = '';
            }

            // Show/hide loading bar
            const loadingBar = document.getElementById('loading-bar');
            if (screenId === 'screen-changes') {
                loadingBar.classList.remove('hidden');
            } else {
                loadingBar.classList.add('hidden');
            }
        }
        
        // Initialize: Set the correct initial state when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            showScreen('screen-changes', 'Downloading Packages');
        });
    </script>
</body>
</html>